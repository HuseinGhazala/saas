# حل مشكلة "Email rate limit exceeded" عند إنشاء حساب جديد

الخطأ يظهر عندما يتجاوز المشروع **حد إرسال رسائل البريد** من Supabase (تأكيد البريد، إعادة تعيين كلمة المرور، إلخ).

---

## 1. رسالة واضحة للعميل (مطبّقة)

تم تعديل صفحة **إنشاء حساب** بحيث إذا حدث هذا الخطأ يظهر للعميل:

> تم تجاوز الحد المسموح من طلبات التسجيل حالياً. يرجى المحاولة بعد ٣٠–٦٠ دقيقة أو التواصل معنا.

بدلاً من النص الإنجليزي الخام.

---

## 2. تقليل استهلاك البريد (يقلل احتمال الوصول للحد)

### أ) إيقاف تأكيد البريد (موصى به للتجربة أو المشاريع الصغيرة)

إذا لا تحتاج أن يفتح العميل رابط تأكيد في البريد قبل الدخول:

1. **Supabase Dashboard** → **Authentication** → **Providers** → **Email**.
2. **Confirm email** → أوقفه (Disable).

بعدها لن يُرسل Supabase بريد تأكيد عند التسجيل، فيقل عدد الإيميلات وتقل فرصة "email rate limit exceeded".

### ب) استخدام SMTP خاص بك (بريد من خادمك أو مزود ثالث)

بدلاً من بريد Supabase الافتراضي (المحدود):

1. **Supabase** → **Project Settings** → **Auth** → **SMTP Settings**.
2. فعّل **Custom SMTP** وأدخل بيانات مزود البريد (مثل SendGrid, Mailgun, أو استضافة تدعم SMTP).
3. بهذا تُرسل رسائل Auth من حسابك وحدود Supabase للإيميل تصبح أقل تأثيراً.

---

## 3. رفع الحد من لوحة Supabase (إن وُجد)

- في **Supabase Dashboard** ابحث عن **Rate Limits** أو **Auth** → **Settings**.
- في الخطط المدفوعة قد توجد خيارات لرفع حدود البريد أو طلب رفع من الدعم.

---

## 4. ملخص سريع

| الإجراء | التأثير |
|--------|---------|
| إيقاف **Confirm email** | أقل إيميلات = أقل احتمال للـ rate limit |
| تفعيل **Custom SMTP** | إرسال من مزودك وضبط حدوده بنفسك |
| رفع الحد من Dashboard / الخطة | زيادة حد Supabase نفسه |

بعد أي تغيير في Auth أو SMTP جرّب إنشاء حساب جديد وتحقق من اختفاء الخطأ أو ظهور الرسالة العربية فقط عند تجاوز الحد.
